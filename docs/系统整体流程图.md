# 智能生产线监控系统 - 整体流程图

> 适用于论文展示，一图了解系统运行机制

---

## 系统整体运行流程图

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    智能生产线监控系统整体流程                                         │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘

                                    ┌─────────────────────┐
                                    │      用户操作       │
                                    │  (Web监控大屏)      │
                                    │ • 启动/停止/暂停    │
                                    │ • 切换生产模式      │
                                    │ • 设置生产计划      │
                                    │ • 处理报警          │
                                    └──────────┬──────────┘
                                               │
                                               │ HTTP/WebSocket
                                               ▼
┌──────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                        后端服务层 (FastAPI)                                          │
│  ┌────────────────────────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                                                │ │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                   │ │
│  │   │  API路由    │    │  WebSocket  │    │  调度引擎   │    │  传送带     │                   │ │
│  │   │  处理器     │    │  管理器     │    │  Scheduler  │    │  管理器     │                   │ │
│  │   │             │    │             │    │             │    │             │                   │ │
│  │   │ • 数据接收  │    │ • 实时推送  │    │ • 温度调度  │    │ • 物品生成  │                   │ │
│  │   │ • 控制指令  │    │ • 状态广播  │    │ • 产量调度  │    │ • 位置更新  │                   │ │
│  │   │ • 状态查询  │    │ • 报警通知  │    │ • 规则执行  │    │ • 计数统计  │                   │ │
│  │   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘                   │ │
│  │          │                  │                  │                  │                          │ │
│  │          └──────────────────┴──────────────────┴──────────────────┘                          │ │
│  │                                        │                                                      │ │
│  └────────────────────────────────────────┼──────────────────────────────────────────────────────┘ │
│                                           │                                                        │
│                                           ▼                                                        │
│                              ┌─────────────────────────┐                                          │
│                              │      MySQL 数据库       │                                          │
│                              │  • 传感器数据存储       │                                          │
│                              │  • 检测记录存储         │                                          │
│                              │  • 报警记录存储         │                                          │
│                              │  • 生产状态存储         │                                          │
│                              └─────────────────────────┘                                          │
└──────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                               ▲
                                               │ HTTP API
                                               │ 数据上报
┌──────────────────────────────────────────────┴───────────────────────────────────────────────────────┐
│                                        设备层 (树莓派/模拟器)                                         │
│                                                                                                      │
│   ┌─────────────────────────────────┐              ┌─────────────────────────────────┐              │
│   │        传感器数据采集           │              │        视觉检测系统             │              │
│   │                                 │              │                                 │              │
│   │  ┌─────────┐  ┌─────────┐      │              │  ┌─────────┐  ┌─────────┐      │              │
│   │  │ DHT11   │  │ 压力    │      │              │  │ 摄像头  │  │ YOLOv8  │      │              │
│   │  │ 温湿度  │  │ 传感器  │      │              │  │ 图像    │  │ 人员    │      │              │
│   │  │ 传感器  │  │         │      │              │  │ 采集    │  │ 检测    │      │              │
│   │  └────┬────┘  └────┬────┘      │              │  └────┬────┘  └────┬────┘      │              │
│   │       │            │           │              │       │            │           │              │
│   │       └──────┬─────┘           │              │       └──────┬─────┘           │              │
│   │              │                 │              │              │                 │              │
│   │              ▼                 │              │              ▼                 │              │
│   │     ┌─────────────────┐       │              │     ┌─────────────────┐       │              │
│   │     │   数据上报      │       │              │     │   区域判定      │       │              │
│   │     │ POST /api/sensor│       │              │     │   人员追踪      │       │              │
│   │     └─────────────────┘       │              │     └────────┬────────┘       │              │
│   └─────────────────────────────────┘              │              │                 │              │
│                                                    │              ▼                 │              │
│                                                    │     ┌─────────────────┐       │              │
│                                                    │     │ 进入危险区?    │       │              │
│                                                    │     └────────┬────────┘       │              │
│                                                    │              │                 │              │
│                                                    │      是 ┌────┴────┐ 否        │              │
│                                                    │         ▼         ▼           │              │
│                                                    │  ┌──────────┐ ┌──────────┐   │              │
│                                                    │  │ 触发报警 │ │ 正常状态 │   │              │
│                                                    │  │ LED+蜂鸣 │ │ 继续监控 │   │              │
│                                                    │  └──────────┘ └──────────┘   │              │
│                                                    │         │                     │              │
│                                                    │         ▼                     │              │
│                                                    │  ┌─────────────────┐         │              │
│                                                    │  │ POST /api/zone/ │         │              │
│                                                    │  │     event       │         │              │
│                                                    │  └─────────────────┘         │              │
│                                                    └─────────────────────────────────┘              │
└──────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 核心数据流向图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                    数据流向示意图                                        │
└─────────────────────────────────────────────────────────────────────────────────────────┘

                              ┌─────────────────────────────┐
                              │         前端大屏            │
                              │    (Vue 3 + ECharts)        │
                              └──────────────┬──────────────┘
                                             │
                         ┌───────────────────┼───────────────────┐
                         │                   │                   │
                    WebSocket           WebSocket            HTTP
                    (实时推送)          (实时推送)          (查询/控制)
                         │                   │                   │
                         ▼                   ▼                   ▼
              ┌──────────────────┐ ┌──────────────────┐ ┌──────────────────┐
              │   传感器数据     │ │   检测结果       │ │   控制指令       │
              │   实时曲线       │ │   视频流         │ │   状态查询       │
              │   报警通知       │ │   报警动画       │ │   历史数据       │
              └──────────────────┘ └──────────────────┘ └──────────────────┘
                         ▲                   ▲                   │
                         │                   │                   │
                         └───────────────────┼───────────────────┘
                                             │
                              ┌──────────────┴──────────────┐
                              │        FastAPI 后端         │
                              │                             │
                              │  ┌───────────────────────┐  │
                              │  │    WebSocket Manager  │  │
                              │  │    (连接管理+广播)    │  │
                              │  └───────────────────────┘  │
                              │              │              │
                              │  ┌───────────┴───────────┐  │
                              │  │                       │  │
                              │  ▼                       ▼  │
                              │ 存储                   推送  │
                              │  │                       │  │
                              │  ▼                       │  │
                              │ MySQL ◄──────────────────┘  │
                              └──────────────┬──────────────┘
                                             │
                                             │ HTTP API
                                             │
                         ┌───────────────────┼───────────────────┐
                         │                   │                   │
                         ▼                   ▼                   ▼
              ┌──────────────────┐ ┌──────────────────┐ ┌──────────────────┐
              │   温度/湿度      │ │   人员检测       │ │   视频帧         │
              │   压力数据       │ │   区域事件       │ │   (Base64)       │
              │   POST /sensor   │ │   POST /zone     │ │   POST /video    │
              └────────┬─────────┘ └────────┬─────────┘ └────────┬─────────┘
                       │                    │                    │
                       └────────────────────┼────────────────────┘
                                            │
                              ┌─────────────┴─────────────┐
                              │       设备端 (树莓派)      │
                              │                           │
                              │  DHT11 + 摄像头 + YOLOv8  │
                              └───────────────────────────┘
```

---

## 自动调度流程图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                    自动调度流程                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘

                    ┌─────────────────────────────────────────────┐
                    │              触发事件                        │
                    └─────────────────────┬───────────────────────┘
                                          │
                    ┌─────────────────────┼─────────────────────┐
                    │                     │                     │
                    ▼                     ▼                     ▼
          ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐
          │   温度上报      │   │   产量更新      │   │   危险区域      │
          │   (传感器)      │   │   (传送带)      │   │   入侵事件      │
          └────────┬────────┘   └────────┬────────┘   └────────┬────────┘
                   │                     │                     │
                   ▼                     ▼                     ▼
          ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐
          │ 温度 ≥ 95°C?   │   │ 产量 ≥ 目标?   │   │ 人员进入?      │
          └────────┬────────┘   └────────┬────────┘   └────────┬────────┘
                   │                     │                     │
              是   │   否          是    │   否          是    │   否
                   │                     │                     │
          ┌────────┴────────┐   ┌────────┴────────┐   ┌────────┴────────┐
          │                 │   │                 │   │                 │
          ▼                 ▼   ▼                 ▼   ▼                 ▼
   ┌────────────┐    ┌────────┐ ┌────────────┐ ┌────────┐ ┌────────────┐ ┌────────┐
   │ 自动暂停   │    │ 继续   │ │ 自动停止   │ │ 继续   │ │ 记录报警   │ │ 继续   │
   │ 生产线     │    │ 运行   │ │ 或切换模式 │ │ 生产   │ │ 触发警报   │ │ 监控   │
   └────────────┘    └────────┘ └────────────┘ └────────┘ └────────────┘ └────────┘
          │                           │                           │
          │                           │                           │
          └───────────────────────────┼───────────────────────────┘
                                      │
                                      ▼
                           ┌─────────────────────┐
                           │   WebSocket 广播    │
                           │   通知前端更新      │
                           └─────────────────────┘
```

---

## 简化版系统流程图（论文推荐）

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          智能生产线监控系统流程图                                        │
└─────────────────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────┐                                              ┌─────────────┐
    │   用户      │                                              │   管理员    │
    └──────┬──────┘                                              └──────┬──────┘
           │                                                            │
           │ 监控/操作                                                  │ 配置/管理
           │                                                            │
           └────────────────────────┬───────────────────────────────────┘
                                    │
                                    ▼
                    ┌───────────────────────────────┐
                    │        Web 监控大屏           │
                    │   ┌─────┐ ┌─────┐ ┌─────┐   │
                    │   │状态 │ │图表 │ │视频 │   │
                    │   │控制 │ │监控 │ │监控 │   │
                    │   └─────┘ └─────┘ └─────┘   │
                    └───────────────┬───────────────┘
                                    │
                          HTTP REST + WebSocket
                                    │
                                    ▼
                    ┌───────────────────────────────┐
                    │        后端服务 (FastAPI)     │
                    │                               │
                    │  ┌─────────────────────────┐  │
                    │  │ • 数据接收与存储        │  │
                    │  │ • 实时状态广播          │  │
                    │  │ • 自动调度引擎          │  │
                    │  │ • 传送带模拟            │  │
                    │  └─────────────────────────┘  │
                    │               │               │
                    │               ▼               │
                    │      ┌─────────────┐         │
                    │      │   MySQL     │         │
                    │      │   数据库    │         │
                    │      └─────────────┘         │
                    └───────────────┬───────────────┘
                                    │
                              HTTP API
                                    │
           ┌────────────────────────┼────────────────────────┐
           │                        │                        │
           ▼                        ▼                        ▼
    ┌─────────────┐          ┌─────────────┐          ┌─────────────┐
    │  传感器     │          │  摄像头     │          │  GPIO       │
    │  数据采集   │          │  视觉检测   │          │  控制输出   │
    │             │          │             │          │             │
    │ • 温度      │          │ • YOLOv8    │          │ • LED指示   │
    │ • 湿度      │          │ • 人员检测  │          │ • 蜂鸣报警  │
    │ • 压力      │          │ • 区域判定  │          │             │
    └─────────────┘          └─────────────┘          └─────────────┘
           │                        │                        │
           └────────────────────────┼────────────────────────┘
                                    │
                                    ▼
                    ┌───────────────────────────────┐
                    │      树莓派 / 边缘设备        │
                    └───────────────────────────────┘
```

---

## 技术架构简图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              技术架构                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         表现层 (Presentation)                        │  │
│   │                                                                     │  │
│   │              Vue 3 + Element Plus + ECharts                         │  │
│   │              WebSocket 实时通信 + HTTP REST API                      │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         业务层 (Business)                            │  │
│   │                                                                     │  │
│   │              FastAPI + SQLAlchemy + Pydantic                        │  │
│   │              WebSocket Manager + Scheduler + Conveyor               │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         数据层 (Data)                                │  │
│   │                                                                     │  │
│   │                         MySQL 8.0                                   │  │
│   │              sensor_data | detection_records | alerts               │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         设备层 (Device)                              │  │
│   │                                                                     │  │
│   │              树莓派 + YOLOv8 + DHT11 + GPIO                         │  │
│   │              摄像头采集 + 传感器读取 + 硬件控制                       │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

